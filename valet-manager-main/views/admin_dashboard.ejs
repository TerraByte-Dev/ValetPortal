<%- include('partials/header', { title: 'Admin Overview' }) %>
<section class="page-header">
  <div>
    <p class="eyebrow">Admin command center</p>
    <h2>Weekly overview</h2>
    <p class="muted">Week: <%= formatEstDate(weekStart) %> - <%= formatEstDate(weekDisplayEnd) %></p>
  </div>
  <div class="button-row">
    <a class="btn btn-ghost week-arrow" href="/admin?week_start=<%= previousWeekStartDate %>" aria-label="Previous week">&lt;</a>
    <a class="btn btn-ghost week-arrow" href="/admin?week_start=<%= nextWeekStartDate %>" aria-label="Next week">&gt;</a>
    <a class="btn btn-primary" href="/admin/analytics">Go to Analytics</a>
    <a class="btn btn-ghost" href="/admin/reports">Shift Report Page</a>
  </div>
</section>

<section class="stat-strip">
  <div class="stat-card">
    <p class="stat-label">Top Valet (Hours)</p>
    <% if (topHours) { %>
      <strong><%= topHours.name %></strong>
      <span class="muted"><%= Number(topHours.total_hours || 0).toFixed(1) %> hours</span>
    <% } else { %>
      <strong>No data yet</strong>
    <% } %>
  </div>
  <div class="stat-card">
    <p class="stat-label">Top Valet (Cash + Digital)</p>
    <% if (topTips) { %>
      <strong><%= topTips.name %></strong>
      <span class="muted">$<%= Number(topTips.total_tips || 0).toFixed(2) %></span>
    <% } else { %>
      <strong>No data yet</strong>
    <% } %>
  </div>
</section>

<section class="card">
  <div class="card-header">
    <h3>Recent shift reports</h3>
    <a href="/admin/reports" class="btn btn-ghost">View all</a>
  </div>
  <div class="report-list">
    <% if (recentReports.length === 0) { %>
      <p class="muted">No reports submitted yet.</p>
    <% } %>
    <% recentReports.forEach(report => { %>
      <a class="report-row" href="/admin/reports/<%= report.id %>">
        <span><%= formatEstDate(report.shift_date) %></span>
        <span><%= report.location_name || 'Unassigned' %></span>
        <span><%= report.valet_name %> <% if (report.shift_notes) { %><span class="note-flag" title="Has shift notes">!</span><% } %></span>
        <span>$<%= Number(report.cash_tips || 0).toFixed(2) %></span>
        <span>$<%= Number(report.online_tips || 0).toFixed(2) %></span>
      </a>
    <% }) %>
  </div>
</section>
<%- include('partials/footer') %>
